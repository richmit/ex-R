<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-06-04 Sat 16:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=1024, initial-scale=1" />
<title>dplyr Examples</title>
<meta name="author" content="Mitch Richling" />
<meta name="description" content="Demo of some of my most used dplyr features.@EOL" />
<meta name="keywords" content="package cran dplyr R" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<style>body { width: 95%; margin: 2% auto; font-size: 18px; line-height: 1.4em; font-family: Georgia, serif; color: black; background-color: white; }</style>
<style>body { min-width: 820px; max-width: 1024px; }</style>
<style>h1,h2,h3,h4,h5,h6 { color: #A5573E; line-height: 1em; font-family: Helvetica, sans-serif; }</style>
<style>h1,h2,h3 { line-height: 1.4em; }</style>
<style>h1.title { font-size: 3em; }</style>
<style>h4,h5,h6 { font-size: 1em; }</style>
<style>.org-src-container { border: 1px solid #ccc; box-shadow: 3px 3px 3px #eee; font-family: Lucida Console, monospace; font-size: 80%; margin: 0px; padding: 0px 0px; position: relative; }</style>
<style>.org-src-container>pre { line-height: 1.2em; padding-top: 1.5em; margin: 0.5em; background-color: #404040; color: white; overflow: auto; }</style>
<style>.org-src-container>pre:before { display: block; position: absolute; background-color: #b3b3b3; top: 0; right: 0; padding: 0 0.2em 0 0.4em; border-bottom-left-radius: 8px; border: 0; color: white; font-size: 100%; font-family: Helvetica, sans-serif;}</style>
<style>pre.example { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; font-family: Lucida Console, monospace; font-size: 80%; background: #404040; color: white; display: block; padding: 0em; border: 2px solid black; }</style>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="https://richmit.github.io/ex-R/"> UP </a>
 |
 <a accesskey="H" href="https://www.mitchr.me/"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">dplyr Examples</h1>
<table border="2 solid #ccc" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right"><b>Author:</b></td>
<td class="org-left"><i>Mitch Richling</i></td>
</tr>

<tr>
<td class="org-right"><b>Updated:</b></td>
<td class="org-left"><i>2022-06-04 16:17:46</i></td>
</tr>
</tbody>
</table>
<p align="center">
Copyright 2020-2021 Mitch Richling. All rights reserved.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org881ebb1">1. Metadata</a></li>
<li><a href="#org37ae34c">2. First Steps</a>
<ul>
<li><a href="#orgd688bf1">2.1. Load the library</a></li>
<li><a href="#orgd0b876b">2.2. Example Data</a></li>
<li><a href="#orga07966a">2.3. Row Names</a></li>
<li><a href="#org7c8a9ae">2.4. Chaining/Pipes vs Nesting vs Assignments</a>
<ul>
<li><a href="#org5c14014">2.4.1. Chaining (Pipes)</a></li>
<li><a href="#orga526d32">2.4.2. Temporary Variables</a></li>
<li><a href="#org2261a12">2.4.3. Composition</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org45edd33">3. Selecting Rows</a>
<ul>
<li><a href="#org07cead1">3.1. With a boolean expression</a></li>
<li><a href="#org4eef0fd">3.2. With an index</a></li>
<li><a href="#org3d76403">3.3. Pull out a sample row for each distinct record</a></li>
</ul>
</li>
<li><a href="#org84e7062">4. Sorting</a></li>
<li><a href="#org7c4043d">5. Selecting Columns</a>
<ul>
<li><a href="#org22d9d12">5.1. With a range</a></li>
<li><a href="#orge2d0ccd">5.2. Select and rename</a></li>
<li><a href="#orgaa414df">5.3. Just rename (but keep other columns)</a></li>
</ul>
</li>
<li><a href="#org4157ecf">6. New columns</a>
<ul>
<li><a href="#org058cdb5">6.1. Compute new columns based on other columns</a></li>
<li><a href="#orge39a06f">6.2. Compute new columns based on other columns and throw away all the old columns</a></li>
</ul>
</li>
<li><a href="#org70f7eaa">7. Aggregation</a>
<ul>
<li><a href="#org71aa152">7.1. Global Aggregation</a></li>
<li><a href="#orgff41fff">7.2. Aggregate by factor level</a></li>
<li><a href="#org932975d">7.3. Aggregate by multiple factors</a></li>
<li><a href="#org1a32373">7.4. Summarize by group and put results back in data frame</a></li>
</ul>
</li>
<li><a href="#orgc0d05f9">8. Join</a>
<ul>
<li><a href="#org979f933">8.1. Example Data For Joins</a></li>
<li><a href="#org8b7bf8d">8.2. Inner Join</a></li>
<li><a href="#orga544a0d">8.3. Left Join</a></li>
<li><a href="#org6184e43">8.4. Right Join</a></li>
<li><a href="#org0a8a9ca">8.5. full outer Join</a></li>
<li><a href="#orgf9e27d9">8.6. Find left matches</a></li>
<li><a href="#org4f8fb0e">8.7. Fixing column names</a></li>
</ul>
</li>
<li><a href="#org5e7f9aa">9. Long &amp; Wide</a>
<ul>
<li><a href="#org3ef72ab">9.1. Long to Wide</a></li>
<li><a href="#org81ae511">9.2. Long to Wide</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org881ebb1" class="outline-2">
<h2 id="org881ebb1"><span class="section-number-2">1.</span> Metadata</h2>
<div class="outline-text-2" id="text-1">
<p>
The home for this HTML file is: <a href="https://richmit.github.io/ex-R/dplyr.html">https://richmit.github.io/ex-R/dplyr.html</a>
</p>

<p>
Files related to this document may be found on github: <a href="https://github.com/richmit/ex-R">https://github.com/richmit/ex-R</a>
</p>

<p>
Directory contents:
</p>
<table border="0" cellspacing="0" cellpadding="6" rules="none" frame="none" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>src</code></td>
<td class="org-left">-</td>
<td class="org-left">The org-mode file that generated this HTML document</td>
</tr>

<tr>
<td class="org-left"><code>docs</code></td>
<td class="org-left">-</td>
<td class="org-left">This html document</td>
</tr>

<tr>
<td class="org-left"><code>data</code></td>
<td class="org-left">-</td>
<td class="org-left">Data files</td>
</tr>

<tr>
<td class="org-left"><code>tangled</code></td>
<td class="org-left">-</td>
<td class="org-left">Tangled R code from this document</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org37ae34c" class="outline-2">
<h2 id="org37ae34c"><span class="section-number-2">2.</span> First Steps</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgd688bf1" class="outline-3">
<h3 id="orgd688bf1"><span class="section-number-3">2.1.</span> Load the library</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #8470ff; font-weight: bold;">library</span>(dplyr)
<span style="color: #8470ff; font-weight: bold;">library</span>(data.table)
<span style="color: #8470ff; font-weight: bold;">library</span>(tidyr)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd0b876b" class="outline-3">
<h3 id="orgd0b876b"><span class="section-number-3">2.2.</span> Example Data</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-R">mtcars
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
</pre>
</div>
</div>
</div>

<div id="outline-container-orga07966a" class="outline-3">
<h3 id="orga07966a"><span class="section-number-3">2.3.</span> Row Names</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">&lt;-</span>
  mtcars <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  tibble::rownames_to_column(<span style="color: #fa8072;">'car_name'</span>) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">            car_name  mpg cyl disp  hp drat    wt  qsec vs am gear carb
1:         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2:     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3:        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4:    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5: Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6:           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
</pre>
</div>
</div>
</div>

<div id="outline-container-org7c8a9ae" class="outline-3">
<h3 id="org7c8a9ae"><span class="section-number-3">2.4.</span> Chaining/Pipes vs Nesting vs Assignments</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Using the Tidyverse tends to lead to deeply nested function calls, which can get a bit messy using traditional infix notation.  Ofcource the LISPers would
tell our syntax is wrong, and the smalltalk peeps would say "just use dots".  The Tidyverse has taken a diffrent appraoch: the pipe.  In UNIX shells the pipe
has long been used as a way to manage a flow of text transformations &#x2013; the essence of many shell scripts.  In R we frequently deal with a flow of data
taransformations, so the pipe concept seems liek a good fit.  After this section, I'll pretty much stick to the "pipe way".
</p>
</div>

<div id="outline-container-org5c14014" class="outline-4">
<h4 id="org5c14014"><span class="section-number-4">2.4.1.</span> Chaining (Pipes)</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Chaining is a technique using the %&gt;% operator that can be used to "chain" together dplyr calls into sequential steps.  Note modern R versions contain native
pipe operators that have slightly different semantics.  In this document I'll stick to the Tidyverse pipe.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::group_by(cyl, carb) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::select(mpg, hp, cyl, carb) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::summarise(meanMPG=mean(mpg, na.rm=<span style="color: #63b8ff;">TRUE</span>),
                   meanCYL=mean(hp,  na.rm=<span style="color: #63b8ff;">TRUE</span>),
                   .groups = <span style="color: #fa8072;">'drop'</span>)  <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  filter(meanMPG &gt; 20) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl carb meanMPG meanCYL
1:   4    1   27.58    77.4
2:   4    2   25.90    87.0
</pre>
</div>
</div>
</div>

<div id="outline-container-orga526d32" class="outline-4">
<h4 id="orga526d32"><span class="section-number-4">2.4.2.</span> Temporary Variables</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
A favorite for FORTRAN programmers!
</p>

<div class="org-src-container">
<pre class="src src-R">tmp <span style="color: #8470ff; font-weight: bold;">&lt;-</span> dplyr::group_by(mtcarsR, cyl, carb)
tmp <span style="color: #8470ff; font-weight: bold;">&lt;-</span> dplyr::select(tmp, mpg, hp, cyl, carb)
tmp <span style="color: #8470ff; font-weight: bold;">&lt;-</span> dplyr::summarise(tmp,
                        meanMPG=mean(mpg, na.rm=<span style="color: #63b8ff;">TRUE</span>),
                        meanCYL=mean(hp,  na.rm=<span style="color: #63b8ff;">TRUE</span>),
                        .groups = <span style="color: #fa8072;">'drop'</span>)
tmp <span style="color: #8470ff; font-weight: bold;">&lt;-</span> dplyr::filter(tmp, meanMPG &gt; 20)
tmp <span style="color: #8470ff; font-weight: bold;">&lt;-</span> data.table::data.table(tmp)
tmp
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl carb meanMPG meanCYL
1:   4    1   27.58    77.4
2:   4    2   25.90    87.0
</pre>
</div>
</div>
</div>

<div id="outline-container-org2261a12" class="outline-4">
<h4 id="org2261a12"><span class="section-number-4">2.4.3.</span> Composition</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
How the LISPers do it, but with worse syntax. ;)
</p>

<div class="org-src-container">
<pre class="src src-R">data.table::data.table(dplyr::filter(dplyr::summarise(dplyr::select(dplyr::group_by(mtcarsR,
                                                                                    cyl,
                                                                                    carb),
                                                                    mpg,
                                                                    hp,
                                                                    cyl,
                                                                    carb),
                                                      meanMPG=mean(mpg, na.rm=<span style="color: #63b8ff;">TRUE</span>),
                                                      meanCYL=mean(hp,  na.rm=<span style="color: #63b8ff;">TRUE</span>),
                                                      .groups = <span style="color: #fa8072;">'drop'</span>),
                                     meanMPG &gt; 20))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl carb meanMPG meanCYL
1:   4    1   27.58    77.4
2:   4    2   25.90    87.0
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org45edd33" class="outline-2">
<h2 id="org45edd33"><span class="section-number-2">3.</span> Selecting Rows</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org07cead1" class="outline-3">
<h3 id="org07cead1"><span class="section-number-3">3.1.</span> With a boolean expression</h3>
<div class="outline-text-3" id="text-3-1">
<p>
You can actually replace that &amp; with a comma, but I'm usually explicit about this sort of thing
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::filter(cyl&gt;4 &amp; carb==4)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
 1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
 2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
 3:          Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
 4:            Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
 5:           Merc 280C 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
 6:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
 7: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
 8:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
 9:          Camaro Z28 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
10:      Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
</pre>
</div>
</div>
</div>

<div id="outline-container-org4eef0fd" class="outline-3">
<h3 id="org4eef0fd"><span class="section-number-3">3.2.</span> With an index</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::slice(15:20)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">              car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
1:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
2: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
3:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
4:            Fiat 128 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
5:         Honda Civic 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
6:      Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d76403" class="outline-3">
<h3 id="org3d76403"><span class="section-number-3">3.3.</span> Pull out a sample row for each distinct record</h3>
<div class="outline-text-3" id="text-3-3">
<p>
More useful if <code>dplyr::select</code> is used to limit input to the column(s)
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::distinct(cyl, carb)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl carb
1:   6    4
2:   4    1
3:   6    1
4:   8    2
5:   8    4
6:   4    2
7:   8    3
8:   6    6
9:   8    8
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org84e7062" class="outline-2">
<h2 id="org84e7062"><span class="section-number-2">4.</span> Sorting</h2>
<div class="outline-text-2" id="text-4">
<p>
Could have used '-gear' here as 'gear' is numeric, but 'desc' works on strings as well.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::arrange(cyl, desc(gear))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
 1:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
 2:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
 3:          Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
 4:           Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
 5:            Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
 6:            Fiat 128 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
 7:         Honda Civic 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
 8:      Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
 9:           Fiat X1-9 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
10:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
11:       Toyota Corona 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
12:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
13:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
14:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
15:            Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
16:           Merc 280C 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
17:      Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
18:             Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
19:      Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
20:       Maserati Bora 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
21:   Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
22:          Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
23:          Merc 450SE 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
24:          Merc 450SL 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
25:         Merc 450SLC 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
26:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
27: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
28:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
29:    Dodge Challenger 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
30:         AMC Javelin 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
31:          Camaro Z28 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
32:    Pontiac Firebird 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
</pre>
</div>
</div>
</div>

<div id="outline-container-org7c4043d" class="outline-2">
<h2 id="org7c4043d"><span class="section-number-2">5.</span> Selecting Columns</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org22d9d12" class="outline-3">
<h3 id="org22d9d12"><span class="section-number-3">5.1.</span> With a range</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Love how you can use column names with the range operator.  Numbers work too, but that is boring.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::select(cyl:drat) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl disp  hp drat
1:   6  160 110 3.90
2:   6  160 110 3.90
3:   4  108  93 3.85
4:   6  258 110 3.08
5:   8  360 175 3.15
6:   6  225 105 2.76
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2d0ccd" class="outline-3">
<h3 id="orge2d0ccd"><span class="section-number-3">5.2.</span> Select and rename</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::select(displacement=disp, cyl) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   displacement cyl
1:          160   6
2:          160   6
3:          108   4
4:          258   6
5:          360   8
6:          225   6
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa414df" class="outline-3">
<h3 id="orgaa414df"><span class="section-number-3">5.3.</span> Just rename (but keep other columns)</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::rename(displacement=disp, weight=wt) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">            car_name  mpg cyl displacement  hp drat weight  qsec vs am gear carb
1:         Mazda RX4 21.0   6          160 110 3.90  2.620 16.46  0  1    4    4
2:     Mazda RX4 Wag 21.0   6          160 110 3.90  2.875 17.02  0  1    4    4
3:        Datsun 710 22.8   4          108  93 3.85  2.320 18.61  1  1    4    1
4:    Hornet 4 Drive 21.4   6          258 110 3.08  3.215 19.44  1  0    3    1
5: Hornet Sportabout 18.7   8          360 175 3.15  3.440 17.02  0  0    3    2
6:           Valiant 18.1   6          225 105 2.76  3.460 20.22  1  0    3    1
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4157ecf" class="outline-2">
<h2 id="org4157ecf"><span class="section-number-2">6.</span> New columns</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org058cdb5" class="outline-3">
<h3 id="org058cdb5"><span class="section-number-3">6.1.</span> Compute new columns based on other columns</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::mutate(mpc=mpg/cyl, impc=1/mpc) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">            car_name  mpg cyl disp  hp drat    wt  qsec vs am gear carb      mpc      impc
1:         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 3.500000 0.2857143
2:     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 3.500000 0.2857143
3:        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 5.700000 0.1754386
4:    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1 3.566667 0.2803738
5: Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2 2.337500 0.4278075
6:           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1 3.016667 0.3314917
</pre>
</div>
</div>
</div>

<div id="outline-container-orge39a06f" class="outline-3">
<h3 id="orge39a06f"><span class="section-number-3">6.2.</span> Compute new columns based on other columns and throw away all the old columns</h3>
<div class="outline-text-3" id="text-6-2">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::transmute(mpc=mpg/cyl, mpd=mpg/disp) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  head()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">        mpc        mpd
1: 3.500000 0.13125000
2: 3.500000 0.13125000
3: 5.700000 0.21111111
4: 3.566667 0.08294574
5: 2.337500 0.05194444
6: 3.016667 0.08044444
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org70f7eaa" class="outline-2">
<h2 id="org70f7eaa"><span class="section-number-2">7.</span> Aggregation</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org71aa152" class="outline-3">
<h3 id="org71aa152"><span class="section-number-3">7.1.</span> Global Aggregation</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::summarize(mean_disp=mean(disp), sd_disp=sd(disp), mean_wt=mean(wt)) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   mean_disp  sd_disp mean_wt
1:  230.7219 123.9387 3.21725
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff41fff" class="outline-3">
<h3 id="orgff41fff"><span class="section-number-3">7.2.</span> Aggregate by factor level</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::group_by(cyl) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::summarize(mean_disp_by_cyl=mean(disp), .groups = <span style="color: #fa8072;">'drop'</span>) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl mean_disp_by_cyl
1:   4         105.1364
2:   6         183.3143
3:   8         353.1000
</pre>
</div>
</div>
</div>

<div id="outline-container-org932975d" class="outline-3">
<h3 id="org932975d"><span class="section-number-3">7.3.</span> Aggregate by multiple factors</h3>
<div class="outline-text-3" id="text-7-3">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::group_by(cyl, gear) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::summarize(, mean_disp_by_cyl_and_gear=mean(disp), .groups = <span style="color: #fa8072;">'drop'</span>) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   cyl gear mean_disp_by_cyl_and_gear
1:   4    3                  120.1000
2:   4    4                  102.6250
3:   4    5                  107.7000
4:   6    3                  241.5000
5:   6    4                  163.8000
6:   6    5                  145.0000
7:   8    3                  357.6167
8:   8    5                  326.0000
</pre>
</div>
</div>
</div>

<div id="outline-container-org1a32373" class="outline-3">
<h3 id="org1a32373"><span class="section-number-3">7.4.</span> Summarize by group and put results back in data frame</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::group_by(cyl, gear) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::mutate(mean_disp_by_cyl_and_gear=mean(disp)) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb mean_disp_by_cyl_and_gear
 1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4                  163.8000
 2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4                  163.8000
 3:          Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1                  102.6250
 4:      Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1                  241.5000
 5:   Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2                  357.6167
 6:             Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1                  241.5000
 7:          Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4                  357.6167
 8:           Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2                  102.6250
 9:            Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2                  102.6250
10:            Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4                  163.8000
11:           Merc 280C 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4                  163.8000
12:          Merc 450SE 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3                  357.6167
13:          Merc 450SL 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3                  357.6167
14:         Merc 450SLC 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3                  357.6167
15:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4                  357.6167
16: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4                  357.6167
17:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4                  357.6167
18:            Fiat 128 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1                  102.6250
19:         Honda Civic 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2                  102.6250
20:      Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1                  102.6250
21:       Toyota Corona 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1                  120.1000
22:    Dodge Challenger 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2                  357.6167
23:         AMC Javelin 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2                  357.6167
24:          Camaro Z28 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4                  357.6167
25:    Pontiac Firebird 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2                  357.6167
26:           Fiat X1-9 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1                  102.6250
27:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2                  107.7000
28:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2                  107.7000
29:      Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4                  326.0000
30:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6                  145.0000
31:       Maserati Bora 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8                  326.0000
32:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2                  102.6250
               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb mean_disp_by_cyl_and_gear
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc0d05f9" class="outline-2">
<h2 id="orgc0d05f9"><span class="section-number-2">8.</span> Join</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org979f933" class="outline-3">
<h3 id="org979f933"><span class="section-number-3">8.1.</span> Example Data For Joins</h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">
<pre class="src src-R">carSurvey <span style="color: #8470ff; font-weight: bold;">&lt;-</span> data.table::fread(header=T, text=<span style="color: #fa8072;">'</span>
<span style="color: #fa8072;">               car_name, GEARS, word</span>
<span style="color: #fa8072;">              Mazda RX4,     4, ZoomZoom</span>
<span style="color: #fa8072;">          Mazda RX4 Wag,     4, ZoomZoom</span>
<span style="color: #fa8072;">     Cadillac Fleetwood,     3, RollingCouch</span>
<span style="color: #fa8072;">    Lincoln Continental,     3, RollingCouch</span>
<span style="color: #fa8072;">               Delorean,    16, TimeWarp</span>
<span style="color: #fa8072;">          Porsche 914-2,     5, SuperCar</span>
<span style="color: #fa8072;">           Lotus Europa,     5, SuperCar</span>
<span style="color: #fa8072;">           Ferrari Dino,     5, SuperCar</span>
<span style="color: #fa8072;">           Ferrari Dino,     5, SuperRedCar</span>
<span style="color: #fa8072;">             Volvo 142E,     4, BoxeyButGood</span>
<span style="color: #fa8072;">   '</span>)
carSurvey
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name GEARS         word
 1:           Mazda RX4     4     ZoomZoom
 2:       Mazda RX4 Wag     4     ZoomZoom
 3:  Cadillac Fleetwood     3 RollingCouch
 4: Lincoln Continental     3 RollingCouch
 5:            Delorean    16     TimeWarp
 6:       Porsche 914-2     5     SuperCar
 7:        Lotus Europa     5     SuperCar
 8:        Ferrari Dino     5     SuperCar
 9:        Ferrari Dino     5  SuperRedCar
10:          Volvo 142E     4 BoxeyButGood
</pre>
</div>

<p>
Notes:
</p>
<ul class="org-ul">
<li>The '<code>gear</code>' column in <code>mtcars</code> and the '<code>GEARS</code>' column in <code>carSurvey</code> are logically the equivlant; however, they have different names!</li>
<li>The '<code>word</code>' column is not very descriptive outside of the <code>carSurvey</code> container.</li>
</ul>
</div>
</div>

<div id="outline-container-org8b7bf8d" class="outline-3">
<h3 id="org8b7bf8d"><span class="section-number-3">8.2.</span> Inner Join</h3>
<div class="outline-text-3" id="text-8-2">
<p>
Here we only get records that match on both the left (x) and right (y) sides.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::inner_join(carSurvey, by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>=<span style="color: #fa8072;">'GEARS'</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">              car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4     ZoomZoom
2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4     ZoomZoom
3:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 RollingCouch
4: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 RollingCouch
5:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2     SuperCar
6:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2     SuperCar
7:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6     SuperCar
8:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6  SuperRedCar
9:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 BoxeyButGood
</pre>
</div>
</div>
</div>

<div id="outline-container-orga544a0d" class="outline-3">
<h3 id="orga544a0d"><span class="section-number-3">8.3.</span> Left Join</h3>
<div class="outline-text-3" id="text-8-3">
<p>
Now we get a record for <b>every</b> record on the left (x), and any records on the right (y) that match one on the left (x).  For the "extra" records with no
matching data on the right (y), <code>NA</code> values are introduced.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::left_join(carSurvey, by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>=<span style="color: #fa8072;">'GEARS'</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
 1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4     ZoomZoom
 2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4     ZoomZoom
 3:          Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1         &lt;NA&gt;
 4:      Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1         &lt;NA&gt;
 5:   Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2         &lt;NA&gt;
 6:             Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1         &lt;NA&gt;
 7:          Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4         &lt;NA&gt;
 8:           Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2         &lt;NA&gt;
 9:            Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2         &lt;NA&gt;
10:            Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4         &lt;NA&gt;
11:           Merc 280C 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4         &lt;NA&gt;
12:          Merc 450SE 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3         &lt;NA&gt;
13:          Merc 450SL 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3         &lt;NA&gt;
14:         Merc 450SLC 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3         &lt;NA&gt;
15:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 RollingCouch
16: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 RollingCouch
17:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4         &lt;NA&gt;
18:            Fiat 128 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1         &lt;NA&gt;
19:         Honda Civic 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2         &lt;NA&gt;
20:      Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1         &lt;NA&gt;
21:       Toyota Corona 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1         &lt;NA&gt;
22:    Dodge Challenger 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2         &lt;NA&gt;
23:         AMC Javelin 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2         &lt;NA&gt;
24:          Camaro Z28 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4         &lt;NA&gt;
25:    Pontiac Firebird 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2         &lt;NA&gt;
26:           Fiat X1-9 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1         &lt;NA&gt;
27:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2     SuperCar
28:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2     SuperCar
29:      Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4         &lt;NA&gt;
30:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6     SuperCar
31:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6  SuperRedCar
32:       Maserati Bora 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8         &lt;NA&gt;
33:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 BoxeyButGood
               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
</pre>
</div>
</div>
</div>

<div id="outline-container-org6184e43" class="outline-3">
<h3 id="org6184e43"><span class="section-number-3">8.4.</span> Right Join</h3>
<div class="outline-text-3" id="text-8-4">
<p>
Now we get a record for <b>every</b> record on the right (y), and any records on the left (x) that match one on the right (y).  For the "extra" records with no
matching data on the left (x), <code>NA</code> values are introduced.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::right_join(carSurvey, by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>=<span style="color: #fa8072;">'GEARS'</span>));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
 1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4     ZoomZoom
 2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4     ZoomZoom
 3:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 RollingCouch
 4: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 RollingCouch
 5:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2     SuperCar
 6:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2     SuperCar
 7:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6     SuperCar
 8:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6  SuperRedCar
 9:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 BoxeyButGood
10:            Delorean   NA  NA    NA  NA   NA    NA    NA NA NA   16   NA     TimeWarp
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a8a9ca" class="outline-3">
<h3 id="org0a8a9ca"><span class="section-number-3">8.5.</span> full outer Join</h3>
<div class="outline-text-3" id="text-8-5">
<p>
Now we get a record for <b>every</b> record on the left (x) and right (y).  Any extra records that don't match the other side get <code>NA</code> values.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::full_join(carSurvey, by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>=<span style="color: #fa8072;">'GEARS'</span>));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
 1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4     ZoomZoom
 2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4     ZoomZoom
 3:          Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1         &lt;NA&gt;
 4:      Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1         &lt;NA&gt;
 5:   Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2         &lt;NA&gt;
 6:             Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1         &lt;NA&gt;
 7:          Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4         &lt;NA&gt;
 8:           Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2         &lt;NA&gt;
 9:            Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2         &lt;NA&gt;
10:            Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4         &lt;NA&gt;
11:           Merc 280C 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4         &lt;NA&gt;
12:          Merc 450SE 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3         &lt;NA&gt;
13:          Merc 450SL 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3         &lt;NA&gt;
14:         Merc 450SLC 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3         &lt;NA&gt;
15:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 RollingCouch
16: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 RollingCouch
17:   Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4         &lt;NA&gt;
18:            Fiat 128 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1         &lt;NA&gt;
19:         Honda Civic 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2         &lt;NA&gt;
20:      Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1         &lt;NA&gt;
21:       Toyota Corona 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1         &lt;NA&gt;
22:    Dodge Challenger 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2         &lt;NA&gt;
23:         AMC Javelin 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2         &lt;NA&gt;
24:          Camaro Z28 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4         &lt;NA&gt;
25:    Pontiac Firebird 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2         &lt;NA&gt;
26:           Fiat X1-9 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1         &lt;NA&gt;
27:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2     SuperCar
28:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2     SuperCar
29:      Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4         &lt;NA&gt;
30:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6     SuperCar
31:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6  SuperRedCar
32:       Maserati Bora 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8         &lt;NA&gt;
33:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 BoxeyButGood
34:            Delorean   NA  NA    NA  NA   NA    NA    NA NA NA   16   NA     TimeWarp
               car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb         word
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf9e27d9" class="outline-3">
<h3 id="orgf9e27d9"><span class="section-number-3">8.6.</span> Find left matches</h3>
<div class="outline-text-3" id="text-8-6">
<p>
Sometimes you just want to filter a table by keeping only records that match some other table.  Note <code>semi_join</code> is not just a <code>left_join</code> followed by the
removal of the right columns: 1) The column titles are from the left side only, and 2) records are not duplicated when multiple matches exist on the right.
</p>

<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::semi_join(carSurvey, by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>=<span style="color: #fa8072;">'GEARS'</span>));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">              car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
3:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
4: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
5:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
6:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
7:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
8:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f8fb0e" class="outline-3">
<h3 id="org4f8fb0e"><span class="section-number-3">8.7.</span> Fixing column names</h3>
<div class="outline-text-3" id="text-8-7">
<div class="org-src-container">
<pre class="src src-R">mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::inner_join(rename(carSurvey, gear=GEARS, survey_word=word), by=c(<span style="color: #fa8072;">'car_name'</span>, <span style="color: #fa8072;">'gear'</span>));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">              car_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb  survey_word
1:           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4     ZoomZoom
2:       Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4     ZoomZoom
3:  Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 RollingCouch
4: Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 RollingCouch
5:       Porsche 914-2 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2     SuperCar
6:        Lotus Europa 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2     SuperCar
7:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6     SuperCar
8:        Ferrari Dino 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6  SuperRedCar
9:          Volvo 142E 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 BoxeyButGood
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5e7f9aa" class="outline-2">
<h2 id="org5e7f9aa"><span class="section-number-2">9.</span> Long &amp; Wide</h2>
<div class="outline-text-2" id="text-9">
<p>
In the past I had an entire page with examples of how to transform data between wide and long formats using various R tools.  Today I almost always use <code>tidyr</code>&#x2026;
</p>

<p>
First we need some long data:
</p>

<div class="org-src-container">
<pre class="src src-R">longData <span style="color: #8470ff; font-weight: bold;">&lt;-</span>
  mtcarsR <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::select(gear, carb, mpg) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::group_by(gear, carb) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  dplyr::summarise(mpg=mean(mpg), .groups = <span style="color: #fa8072;">'drop'</span>) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
longData
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">    gear carb      mpg
 1:    3    1 20.33333
 2:    3    2 17.15000
 3:    3    3 16.30000
 4:    3    4 12.62000
 5:    4    1 29.10000
 6:    4    2 24.75000
 7:    4    4 19.75000
 8:    5    2 28.20000
 9:    5    4 15.80000
10:    5    6 19.70000
11:    5    8 15.00000
</pre>
</div>
</div>

<div id="outline-container-org3ef72ab" class="outline-3">
<h3 id="org3ef72ab"><span class="section-number-3">9.1.</span> Long to Wide</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">
<pre class="src src-R">wideData <span style="color: #8470ff; font-weight: bold;">&lt;-</span>
  longData <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  tidyr::pivot_wider(names_from=carb,
                     names_prefix=<span style="color: #fa8072;">'carb_'</span>,            <span style="color: #ffa500;">### </span><span style="color: #ff7f24;">This prepends "carb_" to the column titles created from the  carb column</span>
                     values_from=mpg) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
wideData
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">   gear   carb_1 carb_2 carb_3 carb_4 carb_6 carb_8
1:    3 20.33333  17.15   16.3  12.62     NA     NA
2:    4 29.10000  24.75     NA  19.75     NA     NA
3:    5       NA  28.20     NA  15.80   19.7     15
</pre>
</div>
</div>
</div>

<div id="outline-container-org81ae511" class="outline-3">
<h3 id="org81ae511"><span class="section-number-3">9.2.</span> Long to Wide</h3>
<div class="outline-text-3" id="text-9-2">
<div class="org-src-container">
<pre class="src src-R">wideData <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  tidyr::pivot_longer(cols=2:7,
                      names_to=<span style="color: #fa8072;">"carb"</span>,
                      names_prefix=<span style="color: #fa8072;">'carb_'</span>,                     <span style="color: #ffa500;">### </span><span style="color: #ff7f24;">Wack the "carb_" we added to the column names.</span>
                      names_transform = list(carb=as.integer),  <span style="color: #ffa500;">#### </span><span style="color: #ff7f24;">Previous line gets rid of the "carb_", but left a string.  Convert it to integers.</span>
                      values_drop_na=<span style="color: #63b8ff;">TRUE</span>,                      <span style="color: #ffa500;">### </span><span style="color: #ff7f24;">Get rid of the NA values we created when we made teh wide dta</span>
                      values_to=<span style="color: #fa8072;">'mpg'</span>) <span style="color: #8470ff; font-weight: bold;">%&gt;%</span>
  data.table::data.table()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">    gear carb      mpg
 1:    3    1 20.33333
 2:    3    2 17.15000
 3:    3    3 16.30000
 4:    3    4 12.62000
 5:    4    1 29.10000
 6:    4    2 24.75000
 7:    4    4 19.75000
 8:    5    2 28.20000
 9:    5    4 15.80000
10:    5    6 19.70000
11:    5    8 15.00000
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
</div>
</body>
</html>
